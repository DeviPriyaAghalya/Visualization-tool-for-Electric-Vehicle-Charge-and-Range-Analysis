var AuthHelper=function(t,e,r){var i=e("#AuthHelperBuildId")[0].value,n=3e3,a=3e3;function o(){return{src:"/img/tableau_sign_in_logo.svg?"+i,width:277,height:58,role:"img",dataTbTestId:"tableau-server-logo"}}function u(t,e){var i={},n=null;return r.isString(t.siteUrlName)?n=t.siteUrlName:r.isNumber(t.siteUrlName)&&!r.isNaN(t.siteUrlName)&&(n=t.siteUrlName.toString()),r.isNull(n)||(i={closePopupWhenDone:!0,site:n,authSetting:e,siteLuid:t.siteLuid,embedded:!0}),"/#/signin?"+EmbeddedAuthHelper.param(i)}function s(){var t=navigator.userAgent;return t.match(/MSIE /i)||t.match(/Trident\/7.0/i)||t.match(/Edge/i)}return{getDefaultLogoAttributes:o,getCustomLogoAttributes:function(t){var e=t&&t.customization||{};if(e.customSignInLogo)return{src:e.customSignInLogo.path,width:Math.min(a,e.customSignInLogo.width),height:Math.min(n,e.customSignInLogo.height),title:e.serverName,role:"img",dataTbTestId:"custom-server-logo"};var r=o();return r.title=e.serverName,r},createLogoWithAttributes:function(t){return e('<div class="tb-logo">').attr({title:t.title,role:t.role,"data-tb-test-id":t.dataTbTestId}).css({height:t.height+"px",width:t.width+"px",backgroundImage:"url("+t.src+")"})},getPrimaryAuthButtonText:function(t){var r=t&&t.customization&&t.customization.serverName,i=e("#AuthHelperLocSignInTo")[0].value,n=e("#AuthHelperLocSignIn")[0].value;return r?EmbeddedAuthHelper.formatText(i,{SERVER_NAME:r}):n},getSignInUrlForTopWindow:function(t){var e={externalRedirect:t.path};return r.isString(t.siteUrlName)&&(e.site=t.siteUrlName),"/#/signin?"+EmbeddedAuthHelper.param(e)},getSignInUrl:u,isMicrosoftBrowser:s,authButtonPressed:function(t,r){var i=u(t,r);s()&&e("#not-working-link").show(),EmbeddedAuthHelper.attemptAuth(i).then((function(){EmbeddedAuthHelper.setPathQueryFragment(t.path)}),(function(t){}))}}}(window,jQuery,_);$((function(){var t=EmbeddedAuthHelper.getQueryParams();if(window!=window.top){var e=$("#primary-auth"),r=$("#secondary-auth"),i=$(".tb-logo-container"),n=["DEFAULT"];_.isString(t.authSettings)&&(n=t.authSettings.split(",")),e.data("authSetting",n[0]),n.length>1?r.data("authSetting",n[1]):r.hide(),VizPortalRequest.send("getServerSettingsUnauthenticated").then((function(t){i.html(AuthHelper.createLogoWithAttributes(AuthHelper.getCustomLogoAttributes(t))),e.text(AuthHelper.getPrimaryAuthButtonText(t))})).fail((function(){i.html(AuthHelper.createLogoWithAttributes(AuthHelper.getDefaultLogoAttributes())),e.text(AuthHelper.getPrimaryAuthButtonText())})).always((function(){$(".tb-container").show()}));var a=e.add(r);a.keypress((function(e){13!=e.which&&32!=e.which||(e.preventDefault(),e.stopPropagation(),AuthHelper.authButtonPressed(t,$(this).data("authSetting")))})),a.click((function(){AuthHelper.authButtonPressed(t,$(this).data("authSetting"))}));var o=t.siteUrlName||"",u=t.path||"";EmbeddedAuthHelper.setBroadcastMessageHandler("redirectToPod"+o,(function(t){var e=t+u;window.location.replace(e)}))}else window.location.href=AuthHelper.getSignInUrlForTopWindow(t)}));