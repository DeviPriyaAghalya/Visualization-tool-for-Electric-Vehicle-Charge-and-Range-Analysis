try{window.parent.postMessage("tableau.completed","*")}catch(e){}window.EmbeddedAuthHelper=function(e,n,t){var r=function(){function e(e){if("undefined"!==e){if("null"===e)return null;if("true"===e)return!0;if("false"===e)return!1;if("NaN"===e)return NaN;if(""===e)return"";var n=Number(e);return t.isNaN(n)?e:n}}function n(n){if(n){var t=n.match(/([^=]*)=?(.*)/);if(t)return[decodeURIComponent(t[1]),e(decodeURIComponent(t[2]))]}}return function(e){return e?t.chain(e.split("&")).map(n).compact().object().value():{}}}();return{attemptAuth:function(){var r,a,o,s,i=n.Deferred();function c(){try{r.close()}catch(e){}r=null}var u=function(e){i.resolve(e),c()},p=function(e){i.reject(e),c()};function l(t){t||(t=""),a&&a.supportsGenericAuth?function(t){var i=JSON.parse(t);"loaded"===i.msgName?function(){if(!r)return;var e={msgRecipient:"webdataconnector",msgName:"init",msgData:{phase:"auth"},props:{connectionName:"",connectionData:"",password:"",username:"",incrementalExtractColumn:"",versionNumber:"2.0"}};r.postMessage(JSON.stringify(e),"*")}():"submit"===i.msgName&&function(t){var r=new FormData;r.append("data_class",a.type),r.append("username",t.props.username),r.append("password",t.props.password),t.props.usernameAlias&&r.append("username_alias",t.props.usernameAlias);o&&r.append("instance_url",o);s&&r.append("role",s);n.ajax({type:"POST",headers:VizPortalRequest.getXsrfHeader(),processData:!1,contentType:!1,url:"/auth/add_generic_auth_credentials?secure="+("https:"===e.location.protocol.toLowerCase()),data:r}).then((function(e){d(e)}))}(i)}(t):d(t)}function d(e){var n=e.match(/errorCode=([^(&|")]*)/);if(n){var t=parseInt(n[1],10)||0;p(t)}else{var r=e.match(/id=([^(&|")]*)/);u(r?r[1]:"")}}return e.tableauPopupComplete=l,n(e).on("message",(function(e){var n=e.originalEvent;if(n.source==r){var a=n.data;t.isString(a)&&l(a)}})),n(e).on("unload",c),function(c,u,l,d){p(),a=u,o=l,s=d,i=new n.Deferred,function(n){var a={width:800,height:600,toolbar:1,resizable:1},o=e.screenLeft||e.screenX,s=e.outerWidth||e.innerWidth,i=e.screenTop||e.screenY,c=e.outerHeight||e.innerHeight;a.left=o+(s-a.width)/2,a.top=i+(c-a.height)/8;var u=t.map(a,(function(e,n){return n+"="+e})).join(",");r=e.open(n,"TableauAuth",u)}(c);try{r.focus()}catch(e){}return i.promise()}}(),deparam:r,param:function(){return n.param.apply(n,arguments).replace(/\+/g,"%20")},setPathQueryFragment:function(n){var t=e.location.protocol+"//"+e.location.host;/^[^\/]/.test(n)&&(n="/"+n),e.location.href=t+n},getQueryParams:function(){return r(e.location.search.slice(1))},formatText:function(e,n){return e.replace(/\{([^}]*)}/g,(function(e,t){var r=n&&n[t];return r||console.error("Missing key: "+t),r||e}))},setBroadcastMessageHandler:function(n,t){if(self.BroadcastChannel){var r=new BroadcastChannel(n);r.onmessage=function(e){console.log("Received auth broadcast message on "+n),t(e.data),r.close()}}else var a=e.setInterval((function(){var r=Cookies.get(n);r&&(console.log("Received auth cookie message on "+n),t(r),e.clearInterval(a))}),100)},postBroadcastMessage:function(n,t){if(self.BroadcastChannel){console.log("Sending auth broadcast message on "+n+" : "+t);var r=new BroadcastChannel(n);r.postMessage(t),r.close()}else{var a=new Date(Date.now()+1e3),o=e.location.host.split(".").slice(-2).join(".");o.indexOf(".")<0&&(o=null),Cookies.set(n,t,{expires:a,domain:o})}}}}(window,jQuery,_),window.VizPortalRequest=function(e,n,t){var r="Response has errors";function a(e){return e.errors&&e.errors[0]}function o(){var n,t={};return t["X-XSRF-TOKEN"]=(n=e.document.cookie.match(new RegExp("(^|;) ?XSRF-TOKEN=([^;]*)(;|$)")))&&n[2],t}return{send:function(e,s){var i={type:"POST",contentType:"application/json;charset=UTF-8",dataType:"json",headers:o(),url:"/vizportal/api/web/v1/"+e,data:JSON.stringify({method:e,params:s})};return n.ajax(i).then((function(e,o,s){return a(e&&e.result)?function(){var e=new n.Deferred;return e.reject.apply(e,t.toArray(arguments)).promise()}(s,r):e.result}))},getResultError:a,ErrorTextStatus:r,getXsrfHeader:o}}(window,jQuery,_);